+++
"type" = "search"
"title" = "Search"
"Searchable" = "false"
"description" = "Search for content within the Go-Enjin website"
"layout" = "full-view"
+++
<section class="block"
         id="main-header"
         data-block-tag="main-header"
         data-block-type="header"
         data-block-profile="outer--inner"
         data-block-padding="top"
         data-block-margins="bottom"
         data-header-level="1"
         data-header-count="1">
    <div class="content">
        <h1>
            <a href="{{ __ .SiteSearchPath }}">{{ _ "Site Search" }} ({{ .Request.Language }})</a>
        </h1>
    </div>
</section>

<form name="site-search" method="get" action="{{ __ .SiteSearchPath }}">
    <article class="block"
             id="site-search-form"
             data-block-tag="site-search-form"
             data-block-type="content"
             data-block-theme="working"
             data-block-profile="outer--inner"
             data-block-padding="none"
             data-block-margins="bottom">
        <div class="content">
            <section>
                <div class="site-search-form-fields">
                    <input type="hidden" name="nonce" value="{{ Nonce "site-search-form" }}" />
                    <input type="search" name="query" placeholder="{{ _ "search terms +must should -not ..." }}" value="{{ .SiteSearchQuery | asHTML }}" autofocus/>
                    <button type="submit" value="submit">
                        <i class="fas fa-search"></i>
                        <span class="sr-only">{{ _ "Search" }}</span>
                    </button>
                </div>
            </section>
        </div>
    </article>
</form>

<article class="block"
         id="site-search-details"
         data-block-tag="site-search-details"
         data-block-type="content"
         data-block-profile="outer--inner"
         data-block-padding="bottom"
         data-block-margins="bottom">
    <div class="content">
        {{- if .SiteSearchResults -}}
        <header>
            <h2>{{ _ "Results" }}</h2>
        </header>
        {{- end -}}
        <section>
            {{- if .SiteSearchResults -}}
            <div style="display:flex;justify-content: space-between;">
                <span style="text-align:left;">{{ .SiteSearchResultSummary }}<br /><mark>{{ .SiteSearchQuery }}</mark></span>
                <span style="text-align:right;">{{ .SiteSearchHitsSummary }}<br />{{ .SiteSearchPageSummary }}</span>
            </div>
            {{- else if .SiteSearchError -}}
            <p>{{ _ "Search error" }}: {{ .SiteSearchError }}</p>
            {{- end -}}
            <ol class="search-results" start="{{ add 1 (mul .SiteSearchPage .SiteSearchSize) }}">
                {{- range $idx, $hit := .SiteSearchResults.Hits }}
                <li>
                    <p class="search-result">
                        <a href="{{ $hit.ID }}">{{ $hit.Fields.title }}</a>
                        <sup title="score: {{ $hit.Score }}">({{ printf "%02.2f" $hit.Score }})</sup>
                    </p>
                    <dl>
                        {{- range $k,$v := $hit.Fragments }}
                        <dt>{{ $k }}</dt>
                        <dd>
                            {{- range $idx,$s := $v }}
                            {{- if ne $idx 0 }}<br/>{{- end }}
                            {{ $s | unescapeHTML | asHTML }}
                            {{- end }}
                        </dd>
                        {{- end }}
                    </dl>
                </li>
                {{- end }}
            </ol>
        </section>
        <a class="jump-top" href="#top">{{ _ "top" }}</a>
    </div>
</article>

{{- if .SiteSearchResults -}}
<article class="block"
         id="site-search-pagination"
         data-block-tag="site-search-pagination"
         data-block-type="content"
         data-block-profile="outer--inner"
         data-block-padding="bottom"
         data-block-margins="bottom">
    <div class="content">
        {{ if ge .SiteSearchPages 1 }}
        <footer>
            <div class="search-pagination">
                {{ if gt .SiteSearchPage 0 }}
                <a title="Go to the first page" href="{{ .SiteSearchPath }}/{{ .SiteSearchQuery | escapeUrlPath }}">
                    <i class="fa-solid fa-angles-left"></i>
                    <span class="sr-only">{{ _ "first" }}</span>
                </a>
                <a title="Go back one page" href="{{ .SiteSearchPath }}/{{ .SiteSearchQuery | escapeUrlPath }}/{{ .SiteSearchSize }}/{{ sub .SiteSearchPage 1 }}">
                    <i class="fa-solid fa-angle-left"></i>
                    <span class="sr-only">{{ _ "back" }}</span>
                </a>
                {{ else }}
                <div><i class="fa-solid fa-angles-left"></i></div>
                <div><i class="fa-solid fa-angle-left"></i></div>
                {{ end }}
                <div class="search-pagination-info">
                    <span class="search-pagination-info--pages">{{ .SiteSearchPageSummary }}</span>
                    <span class="search-pagination-info--hits">({{ .SiteSearchHitsSummary }})</span>
                </div>
                {{ if lt .SiteSearchPage .SiteSearchPages }}
                <a title="Go to the next page" href="{{ .SiteSearchPath }}/{{ .SiteSearchQuery | escapeUrlPath }}/{{ .SiteSearchSize }}/{{ add .SiteSearchPage 1 }}">
                    <i class="fa-solid fa-angle-right"></i>
                    <span class="sr-only">{{ _ "next" }}</span>
                </a>
                <a title="Go to the last page" href="{{ .SiteSearchPath }}/{{ .SiteSearchQuery | escapeUrlPath }}/{{ .SiteSearchSize }}/{{ .SiteSearchPages }}">
                    <i class="fa-solid fa-angles-right"></i>
                    <span class="sr-only">{{ _ "last" }}</span>
                </a>
                {{ else }}
                <div><i class="fa-solid fa-angle-right"></i></div>
                <div><i class="fa-solid fa-angles-right"></i></div>
                {{ end }}
            </div>
        </footer>
        {{ end }}
    </div>
</article>
{{ end }}