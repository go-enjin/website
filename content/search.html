+++
"type" = "search"
"title" = "Search"
"Searchable" = "false"
"description" = "Search for content within the Go-Enjin website"
"layout" = "full-view"
+++
<section class="block"
         id="main-header"
         data-block-tag="main-header"
         data-block-type="header"
         data-block-profile="outer--inner"
         data-block-padding="top"
         data-block-margins="bottom"
         data-header-level="1"
         data-header-count="1">
    <div class="content">
        <h1>
            <a href="{{ .SiteSearchPath }}">Site Search</a>
        </h1>
    </div>
</section>

<article class="block"
         id="site-search-form"
         data-block-tag="site-search-form"
         data-block-type="content"
         data-block-theme="working"
         data-block-profile="outer--inner"
         data-block-padding="none"
         data-block-margins="bottom">
    <div class="content">
        <section>
            <form name="site-search" method="get" action="{{ .SiteSearchPath }}">
                <input type="hidden" name="nonce" value="{{ Nonce "site-search-form" }}" />
                <input type="text" name="query" placeholder="search terms +must should -not ..." value="{{ .SiteSearchQuery | asHTML }}" autofocus/>
                <button type="submit" value="submit">
                    <i class="fas fa-search"></i>
                    <span class="sr-only">Search</span>
                </button>
            </form>
        </section>
    </div>
</article>
<article class="block"
         id="site-search-details"
         data-block-tag="site-search-details"
         data-block-type="content"
         data-block-profile="outer--inner"
         data-block-padding="bottom"
         data-block-margins="bottom">
    <div class="content">
        {{- if .SiteSearchResults -}}
        <header>
            <h2>Results</h2>
        </header>
        {{- end -}}
        <section>
            {{- if .SiteSearchResults -}}
            <p>
                {{ if ge .SiteSearchPages 1 }}
                Showing
                    {{ if gt (len .SiteSearchResults.Hits) 1 }}
                        {{ add (mul .SiteSearchPage .SiteSearchSize) 1 -}}
                        -
                        {{- add (len .SiteSearchResults.Hits) (mul .SiteSearchPage .SiteSearchSize) }}
                    {{ else }}
                        result {{ add 1 (mul .SiteSearchPage .SiteSearchSize) }}
                    {{ end }}
                of
                {{ end }}
                {{ .SiteSearchResults.Total }} result{{ if gt .SiteSearchResults.Total 1 }}s{{ end }} found
                {{- if ge .SiteSearchPages 1 -}},
                on page {{ add .SiteSearchPage 1 }} of {{ add .SiteSearchPages 1 }},
                {{- end }}
                for search: <mark>{{ .SiteSearchQuery | asHTML }}</mark>.
            </p>
            {{- else if .SiteSearchError -}}
            <p>Invalid query: {{ .SiteSearchError }}</p>
            {{- end -}}
            <ol class="search-results" start="{{ add 1 (mul .SiteSearchPage .SiteSearchSize) }}">
                {{- range $idx, $hit := .SiteSearchResults.Hits }}
                <li>
                    <p class="search-result">
                        <a href="{{ $hit.ID }}">{{ $hit.Fields.title }}</a>
                        <sup title="score: {{ $hit.Score }}">({{ printf "%02.2f" $hit.Score }})</sup>
                    </p>
                    <dl>
                        {{- range $k,$v := $hit.Fragments }}
                        <dt>{{ $k }}</dt>
                        <dd>
                            {{- range $idx,$s := $v }}
                            {{- if ne $idx 0 }}<br/>{{- end }}
                            {{ $s | unescapeHTML | asHTML }}
                            {{- end }}
                        </dd>
                        {{- end }}
                    </dl>
                </li>
                {{- end }}
            </ol>
        </section>
        <a class="jump-top" href="#top">top</a>
    </div>
</article>

{{- if .SiteSearchResults -}}
<article class="block"
         id="site-search-pagination"
         data-block-tag="site-search-pagination"
         data-block-type="content"
         data-block-profile="outer--inner"
         data-block-padding="bottom"
         data-block-margins="bottom">
    <div class="content">
        {{ if ge .SiteSearchPages 1 }}
        <footer>
            <div class="search-pagination">
                {{ if gt .SiteSearchPage 0 }}
                <a title="Go to the first page" href="/search/{{ .SiteSearchQuery | asHTML }}">
                    <i class="fa-solid fa-angles-left"></i>
                    <span class="sr-only">first</span>
                </a>
                <a title="Go back one page" href="/search/{{ .SiteSearchQuery | asHTML }}/{{ .SiteSearchSize }}/{{ sub .SiteSearchPage 1 }}">
                    <i class="fa-solid fa-angle-left"></i>
                    <span class="sr-only">back</span>
                </a>
                {{ else }}
                <div><i class="fa-solid fa-angles-left"></i></div>
                <div><i class="fa-solid fa-angle-left"></i></div>
                {{ end }}
                <div class="search-pagination-info">{{ add .SiteSearchPage 1 }} of {{ add .SiteSearchPages 1 }}</div>
                {{ if lt .SiteSearchPage .SiteSearchPages }}
                <a title="Go to the next page" href="/search/{{ .SiteSearchQuery | asHTML }}/{{ .SiteSearchSize }}/{{ add .SiteSearchPage 1 }}">
                    <i class="fa-solid fa-angle-right"></i>
                    <span class="sr-only">next</span>
                </a>
                <a title="Go to the last page" href="/search/{{ .SiteSearchQuery | asHTML }}/{{ .SiteSearchSize }}/{{ .SiteSearchPages }}">
                    <i class="fa-solid fa-angles-right"></i>
                    <span class="sr-only">last</span>
                </a>
                {{ else }}
                <div><i class="fa-solid fa-angle-right"></i></div>
                <div><i class="fa-solid fa-angles-right"></i></div>
                {{ end }}
            </div>
        </footer>
        {{ end }}
    </div>
</article>
{{ end }}